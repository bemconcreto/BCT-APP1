<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bem Concreto Token (BCT) App</title>

    <!-- PWA Metadata para Mobile (Importante para 'Adicionar à Tela de Início') -->
    <meta name="theme-color" content="#121212"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
    <meta name="apple-mobile-web-app-title" content="BCT Token"/>
    
    <!-- Ícone mockado para a tela inicial iOS -->
    <link rel="apple-touch-icon" href="https://placehold.co/192x192/121212/FFD700?text=BCT"/>

    <!-- Manifest Mockup como Data URL (Para simular a PWA - Aponta para o nome e ícone) -->
    <link rel="manifest" href="data:application/json;base64,eyJkZWZhdWx0X3Byb2ZpbGVfZm9ybWF0IjogdHJ1ZSwgIm5hbWUiOiAiQmVtIENvbmNyZXRvIFRva2VuIiwgInNob3J0X25hbWUiOiAiQkNUIiwgImRlc2NyaXB0aW9uIjogIkFwbGljYXRpdm8gZGUgZ2VzdMOjbyBkZSB0b2tlbnMgZGUgaW1vdmVpcy4iLCAic3RhcnRfdXJsIjogIi8iLCAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwgImJhY2tncm91bmRfY29sb3IiOiAiIzEyMTIxMiIsICJ0aGVtZV9jb2xvciI6ICIjRkZENzAwIiwgImljb25zIjogW3sgInNyYyI6ICJodHRwczovL3BsYWNlaG9sZC5jby8xOTJ4MTkyLzEyMTIxMi9GRkQ3MDA/dGV4dD1CQ1QiLCAic2l6ZXMiOiAiMTkyeDE5MiIsICJ0eXBlIjogImltYWdlL3BuZyJ9XX0=">

    <!-- Carregamento do Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Ícones Lucide -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Configuração Customizada do Tailwind: Cores Dourado Metálico e Tipografia -->
    <script>
        tailwind.config = {
            darkMode: 'class', // Habilita o modo escuro
            theme: {
                extend: {
                    colors: {
                        'dark-bg': '#121212', // Fundo principal escuro
                        'dark-card': '#1e1e1e', // Cor dos cards/superfícies
                        'gold-primary': '#FFD700', // Dourado puro (para realce)
                        'gold-metallic': '#C4A116', // Dourado mais escuro e institucional
                        'gold-light': '#FFFACD', // Dourado mais claro para brilho
                    },
                    fontFamily: {
                        sans: ['Montserrat', 'sans-serif'],
                    },
                    // Adiciona um gradiente customizado para botões e fundos escuros
                    backgroundImage: {
                        'dark-gradient': 'linear-gradient(145deg, #1A1A1A 0%, #000000 100%)',
                        'gold-gradient': 'linear-gradient(145deg, #FFD700 0%, #C4A116 100%)',
                    }
                }
            }
        }
    </script>

    <style>
        /* Estilo base para garantir a altura total e rolagem */
        body {
            background-color: #121212;
            color: white;
            font-family: 'Montserrat', sans-serif;
        }

        /* Estilo para o contêiner do aplicativo, garantindo espaço para o menu inferior */
        #app-container {
            padding-bottom: 64px; /* Altura do menu inferior (h-16) + padding (p-2) */
            min-height: 100vh;
            background-image: var(--tw-gradient-to, #000000), var(--tw-gradient-from, #1A1A1A);
            background-attachment: fixed;
        }

        /* Animação de brilho (Hover Dourado) para botões */
        .btn-gold {
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.2);
        }
        .btn-gold:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
        }

        /* Classe para cards flutuantes/com destaque */
        .floating-card {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s ease;
        }

        .floating-card:hover {
            transform: translateY(-3px);
        }

        /* Estilo para a barra de navegação inferior (Mobile) */
        #bottom-nav {
            box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.7);
            background-color: #121212;
            z-index: 50;
        }

        /* Estilo para o indicador de progresso de venda */
        .progress-bar-container {
            background-color: #333;
            border-radius: 9999px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background-image: linear-gradient(90deg, #C4A116 0%, #FFD700 100%);
            transition: width 0.5s ease-in-out;
        }

        /* Animação de Carregamento para o PIX */
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: .5; }
        }
        .animate-pulse-slow {
          animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
        .animate-spin-slow {
            animation: spin 3s linear infinite;
        }
        
        /* Estilo para o iframe Dexscreener */
        .dexscreener-iframe {
            border-radius: 0.75rem; /* rounded-xl */
            width: 100%;
            height: 400px; /* Altura ajustável, mas fixa para melhor UX */
            border: 1px solid rgba(196, 161, 22, 0.5); /* Borda sutil de ouro */
            background-color: #000000;
        }

    </style>
</head>
<body class="dark bg-dark-bg min-h-screen font-sans">

    <!-- Container Principal do Aplicativo -->
    <div id="app-container" class="transition-colors duration-500 p-4 bg-dark-gradient max-w-4xl mx-auto">
        
        <!-- Cabeçalho (Fixo no topo e adaptável) -->
        <header class="flex justify-between items-center p-2 mb-4">
            <h1 class="text-2xl font-bold text-gold-primary">BCT <span class="text-white text-base font-light">Token</span></h1>
            <button id="theme-toggle" class="p-2 rounded-full hover:bg-dark-card transition duration-200">
                <!-- Ícone inicial (Sol) -->
                <i data-lucide="sun" class="w-6 h-6 text-gold-metallic"></i>
            </button>
        </header>

        <!-- Área de Conteúdo Principal (Onde as abas são renderizadas) -->
        <main id="content-area" class="pb-4"></main>

        <!-- Modal Único para Transações e Detalhes de Imóvel -->
        <div id="main-modal" class="fixed inset-0 bg-black bg-opacity-80 z-50 hidden items-center justify-center p-4">
            <div class="bg-dark-card rounded-2xl w-full max-w-lg p-6 floating-card">
                <div class="flex justify-between items-center mb-4">
                    <h3 id="modal-title" class="text-xl font-semibold text-gold-primary"></h3>
                    <button onclick="closeModal()" class="text-white hover:text-gold-primary transition duration-200 p-1">
                        <i data-lucide="x" class="w-6 h-6"></i>
                    </button>
                </div>
                <div id="modal-body" class="max-h-96 overflow-y-auto pr-2">
                    <!-- Conteúdo dinâmico do modal -->
                </div>
            </div>
        </div>

    </div>

    <!-- Barra de Navegação Inferior (Fixo para Mobile) -->
    <nav id="bottom-nav" class="fixed bottom-0 left-0 right-0 h-16 flex justify-around items-center border-t border-gray-800 max-w-4xl mx-auto">
        <button onclick="changePage('dashboard')" data-page="dashboard" class="nav-item flex flex-col items-center text-xs text-gray-500 hover:text-gold-light p-2 transition duration-200 active-nav">
            <i data-lucide="layout-dashboard" class="w-6 h-6"></i>
            <span class="mt-1">Início</span>
        </button>
        <button onclick="changePage('properties')" data-page="properties" class="nav-item flex flex-col items-center text-xs text-gray-500 hover:text-gold-light p-2 transition duration-200">
            <i data-lucide="building-2" class="w-6 h-6"></i>
            <span class="mt-1">Imóveis</span>
        </button>
        <button onclick="changePage('brokers')" data-page="brokers" class="nav-item flex flex-col items-center text-xs text-gray-500 hover:text-gold-light p-2 transition duration-200">
            <i data-lucide="user-check" class="w-6 h-6"></i>
            <span class="mt-1">Corretores</span>
        </button>
        <button onclick="changePage('news')" data-page="news" class="nav-item flex flex-col items-center text-xs text-gray-500 hover:text-gold-light p-2 transition duration-200">
            <i data-lucide="newspaper" class="w-6 h-6"></i>
            <span class="mt-1">Notícias</span>
        </button>
        <button onclick="changePage('profile')" data-page="profile" class="nav-item flex flex-col items-center text-xs text-gray-500 hover:text-gold-light p-2 transition duration-200">
            <i data-lucide="user-circle" class="w-6 h-6"></i>
            <span class="mt-1">Perfil</span>
        </button>
    </nav>

    <!-- JavaScript Principal para Lógica do App -->
    <script>
        // Links das Integrações
        const DEKSCREENER_IFRAME_URL = "https://dexscreener.com/polygon/0xF661C10bF5198B4dAA3311eda14d9588C5444c08?embed=1&theme=dark";
        const POLYGOSCAN_TOKEN_URL = "https://polygonscan.com/token/0xC21Ed26ebF463803A9c8E29496Bc1b606A60cF63";
        
        // Constantes de Mock para Simulação
        const BRL_TO_USD_MOCK = 5.0; // Mock: R$ 5,00 por $1.00 USD
        
        // Dados Mockados
        let mockData = {
            investor: {
                name: "João Silva",
                email: "joao.silva@exemplo.com",
                wallet: "0xAcB...98eD3"
            },
            balance: 15504275.50, // Saldo inicial em BCT
            bctQuote: {
                // Preço mockado atualizado para um valor mais realista e fracionário
                price: 0.000125, // $ 0.000125 USD por BCT
                change: 4.5
            },
            transactions: [
                { type: 'Compra PIX', amount: 1200, hash: '0x1A2...3C4', date: '2025-10-18', status: 'Sucesso' },
                { type: 'Venda R$', amount: 500, hash: '0x5D6...7E8', date: '2025-10-17', status: 'Processando' },
                { type: 'Swap (in)', amount: 5000, hash: '0x9F0...12G', date: '2025-10-16', status: 'Sucesso' },
                { type: 'Swap (out)', amount: 300, hash: '0x3H4...5I6', date: '2025-10-15', status: 'Sucesso' },
            ],
            // ** DADOS DE IMÓVEIS ATUALIZADOS com Valores de Mercado e ROI **
            properties: [
                { 
                    id: 1, 
                    name: "Studio da Saúde", 
                    location: "São Paulo, SP", 
                    marketValue: 278100, // Valor de Mercado
                    purchaseValue: 175100, // Valor Comprado pela Bem Concreto
                    staticROI: 58, // ROI de Valorização
                    minFraction: 50, 
                    img: 'https://placehold.co/600x400/121212/C4A116?text=Studio+Saude', 
                    description: 'Studio moderno no bairro da Saúde, com fácil acesso ao metrô e alta demanda por aluguel.', 
                    sold: 65, 
                    return: 15.0, // Retorno anual estimado
                    photos: ['img1', 'img2'] 
                },
                { 
                    id: 2, 
                    name: "Casa Térrea Mosaico Essence", 
                    location: "Mogi das Cruzes, SP", 
                    marketValue: 1650000, 
                    purchaseValue: 1150000, 
                    staticROI: 43, 
                    minFraction: 150, 
                    img: 'https://placehold.co/600x400/121212/C4A116?text=Casa+Mosaico', 
                    description: 'Casa térrea em condomínio fechado com lazer completo, excelente para investimento ou moradia.', 
                    sold: 85, 
                    return: 12.0, 
                    photos: ['img1', 'img2'] 
                },
                { 
                    id: 3, 
                    name: "Lote Vitta Premium Mogi", 
                    location: "Mogi das Cruzes, SP", 
                    marketValue: 600000, 
                    purchaseValue: 200000, 
                    staticROI: 200, 
                    minFraction: 25, 
                    img: 'https://placehold.co/600x400/121212/C4A116?text=Lote+Vitta', 
                    description: 'Lote em condomínio de alto padrão, ideal para construção com potencial de grande valorização.', 
                    sold: 45, 
                    return: 18.0, 
                    photos: ['img1', 'img2'] 
                },
            ],
            news: [
                { title: "BC Token atinge novo recorde de liquidez", thumb: 'https://placehold.co/100x70/1e1e1e/FFFACD?text=Thumb', date: '20/10/2025' },
            ],
            broker: {
                sales: 12,
                commissions: 875.22, // em BCT
                affiliateLink: "https://bct.app/ref/joaosilva123"
            }
        };
        
        const MOCK_CRYPTOS = ['ETH', 'MATIC', 'USDT', 'DAI']; // Criptos mockadas para Swap

        const contentArea = document.getElementById('content-area');
        const modal = document.getElementById('main-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalBody = document.getElementById('modal-body');
        let pixTimerInterval = null; // Para controlar o timer do PIX/Saque

        let currentPage = 'dashboard';
        let currentTheme = 'dark';

        // Inicialização de Ícones Lucide
        function initializeLucide() {
            lucide.createIcons();
        }

        // --- Funções de Componente ---

        // 1. Início (Dashboard)
        function renderDashboard() {
            const quoteChangeClass = mockData.bctQuote.change >= 0 ? 'text-green-500' : 'text-red-500';
            const quoteIcon = mockData.bctQuote.change >= 0 ? 'trending-up' : 'trending-down';

            // Calcula o valor total em R$ (Mock)
            const totalValueBRL = (mockData.balance * mockData.bctQuote.price * BRL_TO_USD_MOCK);

            const quickActions = `
                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
                    <!-- 1. COMPRAR BCT EM PIX -->
                    <button onclick="startPixPurchaseFlow()" class="btn-gold bg-gold-gradient text-dark-bg p-4 rounded-xl font-bold flex flex-col items-center justify-center text-sm text-center">
                        <i data-lucide="credit-card" class="w-6 h-6 mb-1"></i>
                        Comprar BCT (PIX)
                    </button>
                    <!-- 2. VENDER BCT EM REAL -->
                    <button onclick="startSellForBRLFlow()" class="btn-gold bg-dark-card border border-gold-metallic text-white p-4 rounded-xl font-bold flex flex-col items-center justify-center text-sm text-center">
                        <i data-lucide="tag" class="w-6 h-6 mb-1 text-gold-metallic"></i>
                        Vender BCT (R$)
                    </button>
                    <!-- 3. SWAP DE BCT PARA OUTRAS CRIPTOS -->
                    <button onclick="openSwapModal('BCT para Outras Criptos', 'BCT_TO_OTHER')" class="btn-gold bg-dark-card border border-gray-700 text-white p-4 rounded-xl font-bold flex flex-col items-center justify-center text-sm text-center">
                        <i data-lucide="shuffle" class="w-6 h-6 mb-1"></i>
                        SWAP (BCT → Cripto)
                    </button>
                    <!-- 4. SWAP DE CRIPTOS PARA BCT -->
                    <button onclick="openSwapModal('Outras Criptos para BCT', 'OTHER_TO_BCT')" class="btn-gold bg-dark-card border border-gray-700 text-white p-4 rounded-xl font-bold flex flex-col items-center justify-center text-sm text-center">
                        <i data-lucide="refresh-cw" class="w-6 h-6 mb-1"></i>
                        SWAP (Cripto → BCT)
                    </button>
                </div>
            `;

            const transactionsHtml = mockData.transactions.map(tx => `
                <div class="flex justify-between items-center py-3 border-b border-gray-800 animate-fade-in">
                    <div class="flex items-center">
                        <div class="p-2 mr-3 rounded-full bg-dark-bg border border-gold-metallic">
                            <i data-lucide="${tx.type.includes('Compra') || tx.type.includes('in') ? 'plus-circle' : 'minus-circle'}" class="w-4 h-4 text-gold-primary"></i>
                        </div>
                        <div>
                            <p class="text-sm font-semibold">${tx.type}</p>
                            <p class="text-xs text-gray-500">${tx.hash.substring(0, 8)}...${tx.hash.substring(tx.hash.length - 4)}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-sm ${tx.type.includes('Compra') || tx.type.includes('in') ? 'text-green-400' : 'text-red-400'}">${tx.type.includes('Compra') || tx.type.includes('in') ? '+' : '-'}${tx.amount.toLocaleString('pt-BR', { minimumFractionDigits: 2 })} BCT</p>
                        <p class="text-xs text-gray-500">${tx.date}</p>
                    </div>
                </div>
            `).join('');


            contentArea.innerHTML = `
                <!-- Saldo e Cotação -->
                <div class="flex flex-col md:flex-row gap-4 mb-6">
                    <!-- Saldo BCT -->
                    <div class="floating-card bg-dark-card p-6 rounded-2xl flex-1 border border-gray-800">
                        <p class="text-gray-400 text-sm font-medium">Meu Saldo BCT</p>
                        <h2 class="text-4xl font-bold mt-2 text-gold-light">
                            ${mockData.balance.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                            <span class="text-gold-metallic text-lg ml-1">BCT</span>
                        </h2>
                        <p class="text-gray-500 text-xs mt-1">~ R$ ${totalValueBRL.toLocaleString('pt-BR', { minimumFractionDigits: 2 })} (Cotação Mock)</p>
                    </div>

                    <!-- Card de Cotação Atual -->
                    <div class="floating-card bg-dark-card p-6 rounded-2xl flex-1 border border-gray-800 flex flex-col justify-center">
                        <p class="text-gray-400 text-sm font-medium flex items-center">
                            BCT/USD
                            <i data-lucide="${quoteIcon}" class="w-4 h-4 ml-2 ${quoteChangeClass}"></i>
                        </p>
                        <p class="text-2xl font-bold mt-1 text-white">$ ${mockData.bctQuote.price.toFixed(6)}</p>
                        <p class="text-sm font-semibold ${quoteChangeClass}">${mockData.bctQuote.change > 0 ? '+' : ''}${mockData.bctQuote.change.toFixed(2)}% (24h)</p>
                    </div>
                </div>

                <!-- Botões Rápidos -->
                ${quickActions}

                <!-- Gráfico (Iframe Dexscreener REAL) -->
                <div class="floating-card bg-dark-card p-4 rounded-2xl mb-6 border border-gray-800">
                    <h3 class="text-xl font-semibold mb-3 text-white">Gráfico BCT em Tempo Real</h3>
                    <p class="text-xs text-gray-500 mb-3">O preço exibido abaixo é o valor de mercado atual, em tempo real.</p>
                    <iframe src="${DEKSCREENER_IFRAME_URL}" class="dexscreener-iframe" frameborder="0"></iframe>
                </div>

                <!-- Últimas Transações (PolygonScan Mock Visual) -->
                <div class="floating-card bg-dark-card p-4 rounded-2xl border border-gray-800">
                    <h3 class="text-xl font-semibold mb-3 text-white">Histórico Recente</h3>
                    <p class="text-xs text-gray-500 mb-3">Movimentações simuladas do seu saldo.</p>
                    <div class="space-y-1">
                        ${transactionsHtml}
                        <div class="text-center pt-3">
                            <a href="${POLYGOSCAN_TOKEN_URL}" target="_blank" class="text-gold-metallic text-sm font-medium hover:text-gold-primary transition duration-200 flex items-center justify-center">
                                Ver Token na PolygonScan
                                <i data-lucide="external-link" class="w-4 h-4 ml-2"></i>
                            </a>
                        </div>
                    </div>
                </div>
            `;
            initializeLucide();
        }

        // ----------------------------------------------------
        // --- FLUXO 1: COMPRA POR PIX ---
        // ----------------------------------------------------

        function startPixPurchaseFlow() {
            modalTitle.textContent = "Comprar BCT com PIX";
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            renderPixInput();
        }

        function renderPixInput() {
            modalBody.innerHTML = `
                <p class="text-gray-400 mb-6">Para um processo rápido, digite o valor em **R$** que deseja investir (mínimo R$ 50,00).</p>

                <form id="pix-input-form" onsubmit="event.preventDefault(); handlePixInput()">
                    <div class="relative mb-6">
                        <span class="absolute left-3 top-3 text-gray-400 font-semibold text-lg">R$</span>
                        <input id="input-brl-amount" type="number" step="0.01" min="50" placeholder="Mínimo R$ 50,00" required
                            class="w-full p-3 pl-10 rounded-lg bg-dark-bg border border-gray-700 text-white placeholder-gray-500 text-lg focus:border-gold-metallic">
                    </div>
                    
                    <div class="flex justify-between text-sm text-gray-400 mb-6 p-3 bg-dark-bg rounded-lg border border-gray-800">
                        <p>Cotação Mock (USD/BRL):</p>
                        <p class="text-white">R$ ${BRL_TO_USD_MOCK.toFixed(2)}</p>
                    </div>

                    <button type="submit" class="w-full bg-gold-gradient text-dark-bg p-3 rounded-xl font-bold btn-gold">
                        Próximo: Gerar PIX
                    </button>
                </form>
            `;
            initializeLucide();
        }

        function handlePixInput() {
            const amountBRL = parseFloat(document.getElementById('input-brl-amount').value);
            if (isNaN(amountBRL) || amountBRL < 50) {
                showFeedback("Valor mínimo de R$ 50,00.", "error");
                return;
            }

            const amountUSD = amountBRL / BRL_TO_USD_MOCK;
            const amountBCT = amountUSD / mockData.bctQuote.price;
            
            const taxBRL = 0.50; 
            const finalBRL = amountBRL + taxBRL;

            renderPixPaymentDetails(finalBRL, amountBCT);
        }

        function renderPixPaymentDetails(amountBRL, amountBCT) {
            const staticPixCode = "00020126360014br.gov.bcb.pix0114000000000000005204000053039865802BR5913BEM CONCRETO6008BRASILIA62070503***6304FC71";

            modalBody.innerHTML = `
                <div class="text-center p-2">
                    <h4 class="text-lg font-semibold text-white mb-2">Valor a Pagar via PIX:</h4>
                    <p class="text-3xl font-bold text-green-400 mb-4">R$ ${amountBRL.toFixed(2).replace('.', ',')}</p>
                    <p class="text-sm text-gray-400 mb-6">Você receberá: <span class="font-bold text-gold-light">${amountBCT.toLocaleString('pt-BR', { maximumFractionDigits: 2 })} BCT</span></p>

                    <div class="flex justify-center mb-6">
                        <!-- QR Code Mockup -->
                        <div class="p-4 bg-white rounded-lg border-4 border-gold-metallic">
                            <img src="https://placehold.co/150x150/000000/C4A116?text=QR+CODE+PIX" alt="[attachment_0](attachment)" class="w-36 h-36">
                        </div>
                    </div>

                    <p class="text-sm font-semibold text-white mb-2">Chave Copia e Cola:</p>
                    <div class="flex items-center justify-between bg-dark-bg p-3 rounded-lg mb-6 border border-gold-metallic/50">
                        <p id="pix-key" class="text-xs text-gray-300 truncate font-mono" data-copy-text="${staticPixCode}">${staticPixCode.substring(0, 30)}...</p>
                        <button onclick="copyToClipboard('pix-key', 'Chave PIX copiada!')" class="ml-2 text-gold-metallic hover:text-gold-primary transition duration-200 p-1">
                            <i data-lucide="copy" class="w-5 h-5"></i>
                        </button>
                    </div>

                    <p class="text-xs text-red-400 mb-6">Tempo de expiração simulado: <span id="pix-timer" class="font-bold">05:00</span></p>
                    
                    <button onclick="simulatePaymentConfirmation(${amountBCT}, 'Compra PIX')" class="w-full bg-green-600 text-white p-3 rounded-xl font-bold hover:bg-green-700 transition duration-300">
                        Simular Confirmação do Pagamento
                    </button>
                </div>
            `;
            initializeLucide();
            startPixTimer();
        }

        // Etapa de Confirmação Final (Usada tanto para Compra PIX quanto para Venda R$)
        function simulatePaymentConfirmation(amount, type) {
            if (pixTimerInterval) clearInterval(pixTimerInterval);

            modalTitle.textContent = "Aguardando Confirmação";
            modalBody.innerHTML = `
                <div class="flex flex-col items-center justify-center p-8">
                    <div class="w-16 h-16 border-8 border-t-8 border-gold-metallic border-t-transparent rounded-full animate-spin-slow mb-4"></div>
                    <p class="text-white text-lg font-semibold mb-2">${type.includes('Compra') ? 'Verificando pagamento PIX...' : 'Processando saque para conta...'}</p>
                    <p class="text-gray-400 text-sm">O saldo BCT/R$ será creditado/debitado em segundos após a confirmação.</p>
                </div>
            `;
            
            setTimeout(() => {
                const isBuy = type.includes('Compra');
                const isSell = type.includes('Venda R$');
                
                let amountChange = amount;

                if (isBuy) {
                    mockData.balance += amount;
                } else if (isSell) {
                    mockData.balance -= amount;
                }
                
                mockData.transactions.unshift({ 
                    type: type, 
                    amount: amountChange, 
                    hash: isBuy ? '0xPIX...BCT' : '0xBRD...BRL', 
                    date: new Date().toLocaleDateString('pt-BR'), 
                    status: 'Sucesso' 
                });

                modalTitle.textContent = "Transação Concluída!";
                modalBody.innerHTML = `
                    <div class="flex flex-col items-center justify-center p-4 text-center">
                        <i data-lucide="check-circle" class="w-16 h-16 text-green-500 mb-4"></i>
                        <p class="text-xl font-bold text-white mb-2">Sucesso!</p>
                        <p class="text-gray-400 mb-4">${isBuy ? 'Seu saldo foi atualizado com:' : 'O valor foi enviado para sua conta bancária PIX:'}</p>
                        <p class="text-2xl font-bold text-gold-primary">
                            ${isBuy ? amount.toLocaleString('pt-BR', { maximumFractionDigits: 2 }) + ' BCT' : 'R$ ' + (amount * mockData.bctQuote.price * BRL_TO_USD_MOCK).toLocaleString('pt-BR', { maximumFractionDigits: 2 })}
                        </p>
                        <button onclick="closeModal(); changePage('dashboard');" class="mt-6 w-full bg-gold-gradient text-dark-bg p-3 rounded-xl font-bold btn-gold">
                            Ir para o Painel
                        </button>
                    </div>
                `;
                initializeLucide();

            }, 4000); 
        }

        // ----------------------------------------------------
        // --- FLUXO 2: VENDA DE BCT PARA REAL ---
        // ----------------------------------------------------

        function startSellForBRLFlow() {
            modalTitle.textContent = "Vender BCT por Real (Saque PIX)";
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            renderSellInput();
        }

        function renderSellInput() {
            modalBody.innerHTML = `
                <p class="text-gray-400 mb-6">Digite a quantidade de BCT que deseja vender e receber o valor em R$ via PIX.</p>

                <form id="sell-input-form" onsubmit="event.preventDefault(); handleSellInput()">
                    <div class="relative mb-3">
                        <span class="absolute right-3 top-3 text-gold-metallic font-semibold text-lg">BCT</span>
                        <input id="input-bct-amount-sell" type="number" step="0.01" min="100" placeholder="Mínimo 100 BCT" required
                            class="w-full p-3 pr-16 rounded-lg bg-dark-bg border border-gray-700 text-white placeholder-gray-500 text-lg focus:border-gold-metallic">
                    </div>

                    <p class="text-xs text-gray-500 mb-6">Seu saldo: ${mockData.balance.toLocaleString('pt-BR', { minimumFractionDigits: 2 })} BCT</p>
                    
                    <div class="flex justify-between text-sm text-gray-400 mb-6 p-3 bg-dark-bg rounded-lg border border-gray-800">
                        <p>Valor Estimado em R$:</p>
                        <p id="estimated-brl" class="text-white">R$ 0,00</p>
                    </div>

                    <input type="text" id="pix-key-out" placeholder="Sua Chave PIX (CPF/Email/Telefone)" required
                        class="w-full p-3 mb-4 rounded-lg bg-dark-bg border border-gray-700 text-white placeholder-gray-500 focus:border-gold-metallic">

                    <button type="submit" class="w-full bg-gold-gradient text-dark-bg p-3 rounded-xl font-bold btn-gold">
                        Próximo: Confirmar Venda
                    </button>
                </form>
            `;
            initializeLucide();
            document.getElementById('input-bct-amount-sell').addEventListener('input', updateEstimatedBRL);
        }

        function updateEstimatedBRL() {
            const amountBCT = parseFloat(document.getElementById('input-bct-amount-sell').value) || 0;
            const amountUSD = amountBCT * mockData.bctQuote.price;
            const amountBRL = amountUSD * BRL_TO_USD_MOCK;
            const estimatedBRL = document.getElementById('estimated-brl');
            
            // Simula uma taxa de 1 BRL
            const finalBRL = Math.max(0, amountBRL - 1.00); 

            estimatedBRL.textContent = `R$ ${finalBRL.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;
        }

        function handleSellInput() {
            const amountBCT = parseFloat(document.getElementById('input-bct-amount-sell').value);
            const pixKey = document.getElementById('pix-key-out').value;
            
            if (isNaN(amountBCT) || amountBCT < 100 || amountBCT > mockData.balance) {
                showFeedback("Quantidade inválida ou insuficiente de BCT (mínimo 100).", "error");
                return;
            }
            if (!pixKey.trim()) {
                showFeedback("Por favor, insira sua Chave PIX.", "error");
                return;
            }

            const amountUSD = amountBCT * mockData.bctQuote.price;
            const amountBRL = amountUSD * BRL_TO_USD_MOCK;
            const taxBRL = 1.00;
            const finalBRL = Math.max(0, amountBRL - taxBRL);

            renderSellConfirmation(amountBCT, finalBRL, pixKey);
        }

        function renderSellConfirmation(amountBCT, finalBRL, pixKey) {
             modalBody.innerHTML = `
                <div class="text-center p-2">
                    <h4 class="text-lg font-semibold text-white mb-2">Confirmação de Venda e Saque</h4>
                    <p class="text-3xl font-bold text-red-400 mb-4">-${amountBCT.toLocaleString('pt-BR', { maximumFractionDigits: 2 })} BCT</p>
                    <p class="text-sm text-gray-400 mb-6">Você receberá em sua conta PIX:</p>

                    <div class="floating-card bg-dark-bg p-4 rounded-xl border border-gold-metallic/50 mb-6">
                        <p class="text-lg text-gray-400">Valor Líquido</p>
                        <p class="text-2xl font-bold text-green-400">R$ ${finalBRL.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}</p>
                        <p class="text-xs text-gray-500 mt-2">Chave PIX: ${pixKey.substring(0, 15)}...</p>
                    </div>
                    
                    <p class="text-xs text-red-400 mb-6">A transação levará alguns segundos para ser processada na rede (mock).</p>
                    
                    <button onclick="simulatePaymentConfirmation(${amountBCT}, 'Venda R$')" class="w-full bg-red-600 text-white p-3 rounded-xl font-bold hover:bg-red-700 transition duration-300">
                        Confirmar Venda e Envio PIX
                    </button>
                </div>
            `;
            initializeLucide();
        }

        // ----------------------------------------------------
        // --- FLUXOS 3 & 4: SWAP (GENÉRICO) ---
        // ----------------------------------------------------

        function openSwapModal(title, direction) {
            modalTitle.textContent = "SWAP: " + title;
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            const fromToken = direction.includes('BCT') ? 'BCT' : 'Cripto';
            const toToken = direction.includes('OTHER') ? 'Cripto' : 'BCT';

            let dropdownOptions = '';
            const cryptoOptions = fromToken === 'Cripto' ? MOCK_CRYPTOS : MOCK_CRYPTOS.filter(c => c !== 'BCT');
            cryptoOptions.forEach(c => {
                dropdownOptions += `<option value="${c}">${c}</option>`;
            });

            const fromBalance = fromToken === 'BCT' ? mockData.balance.toLocaleString('pt-BR', { minimumFractionDigits: 2 }) + ' BCT' : '0.5 ETH (Mock)';

            modalBody.innerHTML = `
                <p class="text-gray-400 mb-4">Troque instantaneamente seus tokens ou criptos (simulação).</p>

                <form onsubmit="event.preventDefault(); handleSwap('${fromToken}', '${toToken}')">
                    <!-- Token DE: -->
                    <div class="floating-card bg-dark-bg p-4 rounded-xl border border-gray-700 mb-4">
                        <label class="text-sm text-gray-400 block mb-1">Pagar Com (${fromToken})</label>
                        <div class="flex">
                            <input id="swap-amount" type="number" step="0.01" min="1" placeholder="Quantidade" required
                                class="flex-1 p-2 rounded-l-lg bg-dark-bg border border-r-0 border-gray-700 text-white placeholder-gray-500 focus:border-gold-metallic">
                            <select id="swap-from-token" class="p-2 rounded-r-lg bg-dark-card border border-gray-700 text-gold-metallic">
                                <option value="BCT" ${fromToken === 'BCT' ? 'selected' : ''}>BCT</option>
                                ${fromToken === 'Cripto' ? dropdownOptions : ''}
                            </select>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Saldo: ${fromBalance}</p>
                    </div>

                    <!-- Ícone de Troca -->
                    <div class="text-center my-3">
                        <i data-lucide="chevrons-down-up" class="w-6 h-6 text-gold-metallic"></i>
                    </div>

                    <!-- Token PARA: -->
                    <div class="floating-card bg-dark-bg p-4 rounded-xl border border-gray-700 mb-6">
                        <label class="text-sm text-gray-400 block mb-1">Receber Em (${toToken})</label>
                        <div class="flex">
                            <input type="text" value="Valor Estimado" readonly
                                class="flex-1 p-2 rounded-l-lg bg-dark-bg border border-r-0 border-gray-700 text-white placeholder-gray-500">
                            <select id="swap-to-token" class="p-2 rounded-r-lg bg-dark-card border border-gray-700 text-gold-metallic">
                                <option value="BCT" ${toToken === 'BCT' ? 'selected' : ''}>BCT</option>
                                ${toToken === 'Cripto' ? dropdownOptions : ''}
                            </select>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">Estimativa de Preço (Mock): 1 BCT = 0.0000025 ${toToken !== 'BCT' ? 'ETH' : 'USD'}</p>
                    </div>

                    <button type="submit" class="w-full bg-gold-gradient text-dark-bg p-3 rounded-xl font-bold btn-gold">
                        Executar SWAP
                    </button>
                </form>
            `;
            initializeLucide();
        }

        function handleSwap(fromToken, toToken) {
            const amount = parseFloat(document.getElementById('swap-amount').value);
            const fromAsset = document.getElementById('swap-from-token').value;
            const toAsset = document.getElementById('swap-to-token').value;
            
            if (isNaN(amount) || amount <= 0) {
                showFeedback("Insira uma quantidade válida.", "error");
                return;
            }
            if (fromAsset === toAsset) {
                showFeedback("Não é possível trocar um ativo por ele mesmo.", "error");
                return;
            }
            if (fromAsset === 'BCT' && amount > mockData.balance) {
                 showFeedback("Saldo insuficiente de BCT.", "error");
                return;
            }

            // Simulação de execução
            const transactionType = `${fromAsset} → ${toAsset}`;
            
            modalBody.innerHTML = `
                <div class="flex flex-col items-center justify-center p-8">
                    <div class="w-12 h-12 border-4 border-t-4 border-gold-metallic border-t-transparent rounded-full animate-spin mb-4"></div>
                    <p class="text-white text-lg font-semibold mb-2">Executando SWAP...</p>
                    <p class="text-gray-400 text-sm">Trocando ${amount} ${fromAsset} por ${toAsset} (Simulação).</p>
                </div>
            `;
            
            setTimeout(() => {
                let logType = '';
                let amountChange = amount;

                if (toAsset === 'BCT') {
                    // SWAP para BCT (aumenta saldo)
                    mockData.balance += amount * 1.5; // Ganhando 50% a mais de BCT no mock
                    amountChange = amount * 1.5;
                    logType = 'Swap (in)';
                } else if (fromAsset === 'BCT') {
                    // SWAP de BCT (diminui saldo)
                    mockData.balance -= amount;
                    logType = 'Swap (out)';
                } else {
                    // Cripto para Cripto (BCT não muda, mas registra)
                    logType = 'Swap (Cripto)';
                    amountChange = 0;
                }
                
                mockData.transactions.unshift({ 
                    type: logType, 
                    amount: amountChange, 
                    hash: '0xSWP...DEX', 
                    date: new Date().toLocaleDateString('pt-BR'), 
                    status: 'Sucesso' 
                });

                modalTitle.textContent = "SWAP Concluído!";
                modalBody.innerHTML = `
                    <div class="flex flex-col items-center justify-center p-4 text-center">
                        <i data-lucide="check-circle" class="w-16 h-16 text-green-500 mb-4"></i>
                        <p class="text-xl font-bold text-white mb-2">SWAP de ${fromAsset} para ${toAsset} realizado!</p>
                        <p class="text-gray-400 mb-4">Seu novo saldo BCT é de:</p>
                        <p class="text-2xl font-bold text-gold-primary">
                            ${mockData.balance.toLocaleString('pt-BR', { maximumFractionDigits: 2 })} BCT
                        </p>
                        <button onclick="closeModal(); changePage('dashboard');" class="mt-6 w-full bg-gold-gradient text-dark-bg p-3 rounded-xl font-bold btn-gold">
                            Ir para o Painel
                        </button>
                    </div>
                `;
                initializeLucide();

            }, 3000); // 3 segundos para simular o SWAP
        }

        // --- Funções Auxiliares (JÁ EXISTENTES E REUTILIZADAS) ---
        
        function startPixTimer() {
            let timeLeft = 300; // 5 minutos em segundos
            const timerDisplay = document.getElementById('pix-timer');
            if (!timerDisplay) return;

            if (pixTimerInterval) clearInterval(pixTimerInterval);

            pixTimerInterval = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                if (timeLeft <= 0) {
                    clearInterval(pixTimerInterval);
                    timerDisplay.textContent = 'EXPIRADO';
                    showFeedback("Tempo do PIX expirado. Tente novamente.", "error");
                    setTimeout(closeModal, 2000);
                }
            }, 1000);
        }

        function closeModal() {
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            if (pixTimerInterval) {
                clearInterval(pixTimerInterval);
                pixTimerInterval = null;
            }
        }
        
        function changePage(page) {
            currentPage = page;
            const renderer = pageRenderers[page];
            if (renderer) {
                renderer();
                updateActiveNav(page);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function updateActiveNav(activePage) {
            document.querySelectorAll('.nav-item').forEach(btn => {
                if (btn.dataset.page === activePage) {
                    btn.classList.add('text-gold-primary', 'border-t-2', 'border-gold-primary');
                    btn.classList.remove('text-gray-500', 'border-t-2', 'border-transparent');
                } else {
                    btn.classList.remove('text-gold-primary', 'border-t-2', 'border-gold-primary');
                    btn.classList.add('text-gray-500', 'border-t-2', 'border-transparent');
                }
            });
        }
        
        // --- Funções Auxiliares de Navegação (MOCK) ---
        
        // 2. Imóveis Tokenizados
        function renderProperties() {
            // Imóveis agora usam os dados atualizados no mockData.properties
            const propertiesList = mockData.properties.map(property => `
                <div class="floating-card bg-dark-card rounded-2xl overflow-hidden mb-5 border border-gray-800">
                    <img src="${property.img}" alt="" class="w-full h-40 object-cover">
                    <div class="p-4">
                        <h4 class="text-xl font-semibold text-gold-primary">${property.name}</h4>
                        <p class="text-sm text-gray-400 mb-3">${property.location}</p>
                        
                        <div class="flex justify-between items-center mb-2">
                            <p class="text-sm text-gray-500">Valor Total (Mercado):</p>
                            <p class="text-lg font-bold text-white">R$ ${property.marketValue.toLocaleString('pt-BR')}</p>
                        </div>
                        <div class="flex justify-between items-center mb-4">
                            <p class="text-sm text-gray-500">Fração Mínima:</p>
                            <p class="text-base font-bold text-white">${property.minFraction} BCT</p>
                        </div>

                        <div class="progress-bar-container h-2 mb-4">
                            <div class="progress-fill" style="width: ${property.sold}%;"></div>
                        </div>
                        <p class="text-right text-xs text-gray-400 mb-4">${property.sold}% Vendido</p>

                        <button onclick="openPropertyModal(${property.id})" class="w-full bg-gold-metallic text-dark-bg p-3 rounded-xl font-semibold hover:bg-gold-primary transition duration-300">
                            Detalhes & Investir
                        </button>
                    </div>
                </div>
            `).join('');

            contentArea.innerHTML = `
                <h2 class="text-3xl font-bold mb-6 text-white">Imóveis Tokenizados</h2>
                <p class="text-gray-400 mb-6">Aqui estão todos os imóveis que estão dentro do hub tokenizado.</p>
                <div class="space-y-5">
                    ${propertiesList}
                </div>
            `;
            initializeLucide();
        }

        // 3. Corretores e Parceiros
        function renderBrokers() {
            const isBrokerApproved = true; 
            
            let brokerContent = '';
            if (!isBrokerApproved) {
                brokerContent = `
                    <div class="floating-card bg-dark-card p-6 rounded-2xl border border-gray-800">
                        <h3 class="text-2xl font-semibold mb-4 text-gold-primary">Cadastre-se como Corretor Parceiro</h3>
                        <p class="text-gray-400 mb-6">Preencha o formulário para ter acesso ao seu painel de afiliado e começar a gerar comissões em BCT.</p>
                        <form onsubmit="event.preventDefault(); showFeedback('Solicitação enviada! Aguarde a aprovação.', 'success');">
                            <input type="text" placeholder="Nome Completo" required class="w-full p-3 mb-3 rounded-lg bg-dark-bg border border-gray-700 text-white placeholder-gray-500">
                            <input type="text" placeholder="CRECI" required class="w-full p-3 mb-3 rounded-lg bg-dark-bg border border-gray-700 text-white placeholder-gray-500">
                            <input type="text" placeholder="Cidade/Estado" required class="w-full p-3 mb-3 rounded-lg bg-dark-bg border border-gray-700 text-white placeholder-gray-500">
                            <input type="email" placeholder="E-mail" required class="w-full p-3 mb-3 rounded-lg bg-dark-bg border border-gray-700 text-white placeholder-gray-500">
                            <input type="tel" placeholder="Telefone" required class="w-full p-3 mb-4 rounded-lg bg-dark-bg border border-gray-700 text-white placeholder-gray-500">
                            <button type="submit" class="w-full bg-gold-metallic text-dark-bg p-3 rounded-xl font-semibold hover:bg-gold-primary transition duration-300">
                                Solicitar Aprovação
                            </button>
                        </form>
                    </div>
                `;
            } else {
                brokerContent = `
                    <h2 class="text-3xl font-bold mb-6 text-white">Painel do Corretor</h2>
                    
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div class="floating-card bg-dark-card p-4 rounded-xl border border-gold-metallic/50">
                            <p class="text-gray-400 text-sm">Vendas Realizadas</p>
                            <p class="text-3xl font-bold mt-1 text-gold-light">${mockData.broker.sales}</p>
                        </div>
                        <div class="floating-card bg-dark-card p-4 rounded-xl border border-gold-metallic/50">
                            <p class="text-gray-400 text-sm">Comissões Acumuladas</p>
                            <p class="text-3xl font-bold mt-1 text-gold-light">${mockData.broker.commissions.toFixed(2)}</p>
                            <span class="text-sm text-gold-metallic">BCT</span>
                        </div>
                    </div>

                    <div class="floating-card bg-dark-card p-6 rounded-2xl border border-gray-800 mb-6">
                        <h3 class="text-xl font-semibold mb-3 text-white">Seu Link de Afiliado</h3>
                        <p class="text-sm text-gray-400 mb-3">Compartilhe este link e comece a ganhar comissões:</p>
                        <div class="flex items-center justify-between bg-dark-bg p-3 rounded-lg mb-4 border border-gold-metallic/50">
                            <p id="affiliate-link" class="text-sm text-gray-300 truncate">${mockData.broker.affiliateLink}</p>
                            <button onclick="copyToClipboard('affiliate-link', 'Link copiado!')" class="ml-2 text-gold-metallic hover:text-gold-primary transition duration-200 p-1">
                                <i data-lucide="copy" class="w-5 h-5"></i>
                            </button>
                        </div>
                        
                        <div class="flex justify-center mb-4">
                            <div class="p-2 bg-white rounded-lg">
                                <img src="https://placehold.co/100x100/121212/C4A116?text=QR+Code" alt="" class="w-24 h-24">
                            </div>
                        </div>

                        <button onclick="openModal('Sacar Comissão', 'Saque de comissão')" class="w-full bg-gold-gradient text-dark-bg p-3 rounded-xl font-bold btn-gold">
                            Sacar Comissão (${mockData.broker.commissions.toFixed(2)} BCT)
                        </button>
                    </div>
                `;
            }

            contentArea.innerHTML = brokerContent;
            initializeLucide();
        }

        // 4. Notícias e Atualizações
        function renderNews() {
            const newsList = mockData.news.map(item => `
                <div class="floating-card bg-dark-card p-4 rounded-2xl flex border border-gray-800 mb-4">
                    <img src="${item.thumb}" alt="" class="w-24 h-16 object-cover rounded-lg mr-4">
                    <div class="flex-1">
                        <h4 class="text-base font-semibold text-white mb-1">${item.title}</h4>
                        <p class="text-xs text-gray-500 mb-2">${item.date}</p>
                        <button onclick="showFeedback('Abrindo artigo...', 'info')" class="text-gold-metallic text-sm font-medium hover:text-gold-primary transition duration-200">
                            Ler mais
                        </button>
                    </div>
                </div>
            `).join('');

            contentArea.innerHTML = `
                <h2 class="text-3xl font-bold mb-6 text-white">Notícias e Atualizações</h2>
                <p class="text-gray-400 mb-6">Fique por dentro das novidades do mercado imobiliário e da Bem Concreto.</p>
                <div class="space-y-4">
                    ${newsList}
                </div>
            `;
            initializeLucide();
        }

        // 5. Perfil / Configurações
        function renderProfile() {
            contentArea.innerHTML = `
                <h2 class="text-3xl font-bold mb-6 text-white">Perfil e Configurações</h2>
                
                <div class="floating-card bg-dark-card p-6 rounded-2xl border border-gray-800 mb-6">
                    <h3 class="text-xl font-semibold mb-4 text-gold-primary">Dados Pessoais</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between border-b border-gray-700 pb-2">
                            <p class="text-gray-400">Nome:</p>
                            <p class="text-white font-medium">${mockData.investor.name}</p>
                        </div>
                        <div class="flex justify-between border-b border-gray-700 pb-2">
                            <p class="text-gray-400">E-mail:</p>
                            <p class="text-white font-medium">${mockData.investor.email}</p>
                        </div>
                        <div class="flex justify-between items-center">
                            <p class="text-gray-400">Endereço da Carteira:</p>
                            <div class="flex items-center">
                                <p class="text-sm text-white font-mono truncate mr-2">${mockData.investor.wallet.substring(0, 6)}...${mockData.investor.wallet.substring(mockData.investor.wallet.length - 4)}</p>
                                <button onclick="copyToClipboard('wallet-address', 'Endereço da carteira copiado!')" class="text-gold-metallic hover:text-gold-primary p-1">
                                    <i data-lucide="copy" class="w-4 h-4" id="wallet-address" data-copy-text="${mockData.investor.wallet}"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="floating-card bg-dark-card p-6 rounded-2xl border border-gray-800 mb-6">
                    <h3 class="text-xl font-semibold mb-4 text-gold-primary">Conexão de Carteira</h3>
                    <button onclick="showFeedback('Conectando via Metamask...', 'info')" class="w-full bg-dark-bg border border-gray-700 text-white p-3 rounded-xl mb-3 flex items-center justify-center hover:border-gold-metallic transition duration-300">
                        <img src="https://upload.wikimedia.org/wikipedia/en/3/36/MetaMask_Logo.png" alt="" class="w-6 h-6 mr-3">
                        Conectar Metamask
                    </button>
                    <button onclick="showFeedback('Conectando via WalletConnect...', 'info')" class="w-full bg-dark-bg border border-gray-700 text-white p-3 rounded-xl flex items-center justify-center hover:border-gold-metallic transition duration-300">
                        <img src="https://walletconnect.com/img/walletconnect-logo.svg" alt="" class="w-6 h-6 mr-3">
                        Conectar WalletConnect
                    </button>
                </div>

                <div class="floating-card bg-dark-card p-6 rounded-2xl border border-gray-800 mb-6">
                    <h3 class="text-xl font-semibold mb-4 text-gold-primary">Histórico de Transações Pessoais</h3>
                    <div class="text-center">
                        <button onclick="openModal('Histórico Pessoal', 'histórico de transações pessoais')" class="text-gold-metallic text-sm font-medium hover:text-gold-primary transition duration-200">
                            Ver Histórico Detalhado (Mockup)
                        </button>
                    </div>
                </div>

                <div class="floating-card bg-dark-card p-6 rounded-2xl border border-gray-800">
                    <h3 class="text-xl font-semibold mb-4 text-gold-primary">Aparência</h3>
                    <div class="flex justify-between items-center">
                        <p class="text-gray-400">Modo</p>
                        <div class="flex items-center">
                            <i data-lucide="sun" class="w-5 h-5 text-gray-400 mr-2"></i>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" value="" class="sr-only peer" id="dark-mode-switch">
                                <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-gold-metallic"></div>
                            </label>
                            <i data-lucide="moon" class="w-5 h-5 text-gray-400 ml-2"></i>
                        </div>
                    </div>
                </div>
            `;
            initializeLucide();
            document.getElementById('dark-mode-switch').checked = (currentTheme === 'dark');
            document.getElementById('dark-mode-switch').addEventListener('change', toggleTheme);
        }

        const pageRenderers = {
            'dashboard': renderDashboard,
            'properties': renderProperties,
            'brokers': renderBrokers,
            'news': renderNews,
            'profile': renderProfile
        };

        function openModal(title, contentName) {
            modalTitle.textContent = title;
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            
            modalBody.innerHTML = `
                <p class="text-gray-400">Esta é uma simulação da interface para ${contentName}.</p>
                <div class="p-4 mt-4 bg-dark-bg rounded-lg border border-gray-700">
                    <p class="text-sm text-gold-metallic">Conteúdo detalhado ou formulário seria carregado aqui.</p>
                </div>
            `;
            initializeLucide();
        }
        
        function openPropertyModal(propertyId) {
            const property = mockData.properties.find(p => p.id === propertyId);
            if (!property) return;

            modalTitle.textContent = property.name;
            modal.classList.remove('hidden');
            modal.classList.add('flex');

            const galleryHtml = property.photos.map(p => 
                `<img src="${property.img}" alt="" class="w-full h-32 object-cover rounded-lg mb-2 border border-gray-700">`
            ).join('');

            modalBody.innerHTML = `
                <h4 class="text-xl font-semibold text-gold-primary mb-3">${property.location}</h4>
                <p class="text-gray-400 mb-4">${property.description}</p>
                
                <div class="progress-bar-container h-3 mb-4">
                    <div class="progress-fill" style="width: ${property.sold}%;"></div>
                </div>
                <p class="text-right text-sm text-gray-400 mb-6">${property.sold}% das Frações Vendidas</p>

                <!-- Detalhes Financeiros Atualizados -->
                <div class="grid grid-cols-2 gap-4 mb-3 text-center">
                    <div class="bg-dark-bg p-4 rounded-xl border border-gray-700">
                        <p class="text-sm text-gray-400">Valor de Mercado</p>
                        <p class="text-lg font-bold text-white">R$ ${property.marketValue.toLocaleString('pt-BR')}</p>
                    </div>
                    <div class="bg-dark-bg p-4 rounded-xl border border-gray-700">
                        <p class="text-sm text-gray-400">Valor Comprado (BC)</p>
                        <p class="text-lg font-bold text-red-400">R$ ${property.purchaseValue.toLocaleString('pt-BR')}</p>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mb-6 text-center">
                    <div class="bg-dark-bg p-4 rounded-xl border border-gray-700">
                        <p class="text-sm text-gray-400">ROI (Valorização)</p>
                        <p class="text-lg font-bold text-green-400">${property.staticROI}%</p>
                    </div>
                    <div class="bg-dark-bg p-4 rounded-xl border border-gray-700">
                        <p class="text-sm text-gray-400">Retorno Anual (Est.)</p>
                        <p class="text-lg font-bold text-gold-primary">${property.return}% a.a.</p>
                    </div>
                </div>

                <h4 class="text-lg font-semibold text-white mb-3">Galeria de Fotos (Mock)</h4>
                <div class="grid grid-cols-2 gap-3 mb-6">
                    ${galleryHtml}
                </div>

                <button onclick="showTransactionFlow('${property.name}')" class="w-full bg-gold-gradient text-dark-bg p-3 rounded-xl font-bold btn-gold">
                    Investir Neste Imóvel
                </button>
            `;
            initializeLucide();
        }

        function showTransactionFlow(propertyName) {
            modalTitle.textContent = `Investir em ${propertyName}`;
            modalBody.innerHTML = `
                <p class="text-gray-400 mb-4">Defina o valor do investimento em BCT. Fração mínima: ${mockData.properties[0].minFraction} BCT.</p>
                <div class="space-y-4">
                    <div class="relative">
                        <input id="invest-amount" type="number" placeholder="Valor em BCT (ex: 500)" required class="w-full p-3 pr-16 rounded-lg bg-dark-bg border border-gray-700 text-white placeholder-gray-500">
                        <span class="absolute right-3 top-3 text-gold-metallic font-semibold">BCT</span>
                    </div>

                    <div class="flex justify-between items-center text-sm text-gray-400 p-3 bg-dark-bg rounded-lg border border-gray-700">
                        <p>Frações Adquiridas (Est.):</p>
                        <p class="text-white">~ ${((500 / mockData.properties[0].minFraction) * 0.01).toFixed(4)}%</p>
                    </div>

                    <button onclick="executeTransaction('Investimento em Imóvel')" class="w-full bg-gold-gradient text-dark-bg p-3 rounded-xl font-bold btn-gold">
                        Confirmar Investimento
                    </button>
                </div>
            `;
            initializeLucide();
        }

        function executeTransaction(action) {
            modalBody.innerHTML = `
                <div class="flex flex-col items-center justify-center p-8">
                    <div class="w-12 h-12 border-4 border-t-4 border-gold-metallic border-t-transparent rounded-full animate-spin mb-4"></div>
                    <p class="text-white text-lg font-semibold mb-2">Processando ${action}...</p>
                    <p class="text-gray-400 text-sm">Aguardando confirmação da rede Polygon (simulação).</p>
                </div>
            `;

            setTimeout(() => {
                showFeedback(`Sucesso! Sua solicitação de ${action} foi processada.`, 'success');
                closeModal();
                changePage(currentPage);
            }, 2500);
        }
        
        function showFeedback(message, type = 'info') {
            const colors = {
                success: 'bg-green-600',
                error: 'bg-red-600',
                info: 'bg-blue-600'
            };

            const alert = document.createElement('div');
            alert.className = `p-3 rounded-lg text-white shadow-lg floating-card transition-transform duration-300 transform translate-x-full ${colors[type]}`;
            alert.textContent = message;
            feedbackContainer.appendChild(alert);

            setTimeout(() => {
                alert.classList.remove('translate-x-full');
            }, 10);

            setTimeout(() => {
                alert.classList.add('translate-x-full');
                alert.addEventListener('transitionend', () => alert.remove());
            }, 4000);
        }

        function copyToClipboard(elementId, successMessage) {
            const element = document.getElementById(elementId);
            const textToCopy = element.dataset.copyText || element.textContent.trim();

            const tempInput = document.createElement('textarea');
            tempInput.value = textToCopy;
            document.body.appendChild(tempInput);
            tempInput.select();
            document.execCommand('copy');
            document.body.removeChild(tempInput);
            
            showFeedback(successMessage, 'success');
        }

        function toggleTheme() {
            const isDark = document.getElementById('dark-mode-switch').checked;
            currentTheme = isDark ? 'dark' : 'light';
            document.documentElement.classList.toggle('dark', isDark);

            const icon = document.querySelector('#theme-toggle i');
            icon.dataset.lucide = isDark ? 'sun' : 'moon';
            initializeLucide();
            
            if (isDark) {
                document.body.style.backgroundColor = '#121212';
            } else {
                document.body.style.backgroundColor = '#f0f0f0';
            }
        }

        // Adiciona um contêiner para feedback (alerts)
        const feedbackContainer = document.createElement('div');
        feedbackContainer.id = 'feedback-container';
        feedbackContainer.className = 'fixed top-4 right-4 z-50 space-y-2 max-w-xs';
        document.body.appendChild(feedbackContainer);

        // Inicialização do Aplicativo
        document.addEventListener('DOMContentLoaded', () => {
            document.documentElement.classList.add('dark'); 
            changePage('dashboard');

            document.getElementById('theme-toggle').addEventListener('click', () => {
                document.getElementById('dark-mode-switch').click();
            });
            
            initializeLucide();
        });

    </script>
</body>
</html>

